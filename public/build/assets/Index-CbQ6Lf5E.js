import{r as j,j as s,H as b,L as c,b as m,z as g}from"./app-9nS-Mm4e.js";import{u as k,S,T,C as y}from"./useFlashToast-C249PXxX.js";import{B as x}from"./Button-DtSZ5ZSY.js";import{C as u,a as _,b as D,c as C}from"./Card-gbBR4fyZ.js";import{S as K}from"./SearchBox-DlmGgGNR.js";import{T as P}from"./TahunAjaranSelect-bKYOORGD.js";import{u as L}from"./useAOS-Dj5LRxol.js";import{A}from"./AdminLayout-DPSUws_u.js";import{P as U}from"./plus-IeqsPJ_v.js";import{U as B}from"./users-DE606EQy.js";import"./createLucideIcon-oTywQYJd.js";import"./map-pin-D-MawlvD.js";import"./x-BqjMX6yR.js";import"./graduation-cap-8JamamWt.js";function W({dataSiswas:i,sekolahs:r,filters:l}){k(),L();const[n,d]=j.useState(null),[w,o]=j.useState(!1),p=e=>{d(e),o(!0)},f=()=>{if(n){const e=typeof route=="function"&&route("admin.data-siswa.destroy",n)&&route("admin.data-siswa.destroy",n)!=="#"||`/admin/data-siswa/${n}`;m.delete(e,{preserveScroll:!0,onSuccess:()=>{o(!1),d(null)},onError:()=>{g.error("Gagal menghapus data siswa")}})}},v=e=>{const a=e.jml_kelas_7+e.jml_kelas_8+e.jml_kelas_9,t=e.jml_siswa_l_7+e.jml_siswa_l_8+e.jml_siswa_l_9,h=e.jml_siswa_p_7+e.jml_siswa_p_8+e.jml_siswa_p_9,N=t+h;return{totalKelas:a,totalL:t,totalP:h,totalSiswa:N}};return s.jsxs(A,{title:"Kelola Data Siswa",children:[s.jsx(b,{title:"Kelola Data Siswa"}),s.jsxs("div",{className:"mx-auto max-w-7xl",children:[s.jsxs("div",{className:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Data Siswa"}),s.jsx("p",{className:"text-sm text-base-content/70",children:"Kelola data siswa per sekolah dan tahun ajaran"})]}),s.jsx(c,{href:typeof route=="function"&&route("admin.data-siswa.create")&&route("admin.data-siswa.create")!=="#"||"/admin/data-siswa/create",children:s.jsxs(x,{variant:"primary",children:[s.jsx(U,{className:"mr-2 h-4 w-4"}),"Tambah Data Siswa"]})})]}),s.jsx(K,{placeholder:"Cari data siswa (sekolah, tahun ajaran)...",searchUrl:typeof route=="function"&&route("admin.data-siswa.index")&&route("admin.data-siswa.index")!=="#"||"/admin/data-siswa",resetUrl:typeof route=="function"&&route("admin.data-siswa.index")&&route("admin.data-siswa.index")!=="#"||"/admin/data-siswa",defaultValue:l?.search||""}),s.jsx(u,{className:"mb-6",children:s.jsx(_,{children:s.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[r&&r.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"label-text mb-2 block",children:"Filter Sekolah:"}),s.jsxs("select",{className:"select select-bordered w-full",value:l?.sekolah||"",onChange:e=>{const a=typeof route=="function"&&route("admin.data-siswa.index")&&route("admin.data-siswa.index")!=="#"||"/admin/data-siswa";m.get(a,{...l,sekolah:e.target.value||null},{preserveState:!0})},children:[s.jsx("option",{value:"",children:"Semua Sekolah"}),r.map(e=>s.jsx("option",{value:e.id,children:e.nm_sekolah},e.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"label-text mb-2 block",children:"Filter Tahun Ajaran:"}),s.jsx(P,{value:l?.thn_ajaran||"",onChange:e=>{const a=typeof route=="function"&&route("admin.data-siswa.index")&&route("admin.data-siswa.index")!=="#"||"/admin/data-siswa";m.get(a,{...l,thn_ajaran:e||null},{preserveState:!0})},required:!1,showPlaceholder:!0})]})]})})}),s.jsxs(u,{children:[s.jsx(D,{children:s.jsx(C,{children:"Daftar Data Siswa"})}),s.jsxs(_,{children:[i.data.length===0?s.jsxs("div",{className:"py-12 text-center",children:[s.jsx(B,{className:"mx-auto h-12 w-12 text-base-content/30"}),s.jsx("p",{className:"mt-4 text-base-content/70",children:l?.search||l?.sekolah||l?.thn_ajaran?"Tidak ada data siswa yang ditemukan.":"Belum ada data siswa."})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsx("th",{children:"Sekolah"}),s.jsx("th",{children:"Tahun Ajaran"}),s.jsx("th",{children:"Kelas 7"}),s.jsx("th",{children:"Kelas 8"}),s.jsx("th",{children:"Kelas 9"}),s.jsx("th",{children:"Total"}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:i.data.map((e,a)=>{const t=v(e);return s.jsxs("tr",{children:[s.jsx("td",{children:i.from+a}),s.jsxs("td",{children:[s.jsx("div",{className:"font-semibold",children:e.sekolah?.nm_sekolah||"-"}),e.sekolah?.npsn&&s.jsxs("div",{className:"text-xs text-base-content/70",children:["NPSN: ",e.sekolah.npsn]})]}),s.jsx("td",{children:s.jsx("div",{className:"font-semibold",children:e.thn_ajaran})}),s.jsx("td",{children:s.jsxs("div",{className:"text-sm",children:[s.jsxs("div",{children:["Kelas: ",e.jml_kelas_7]}),s.jsxs("div",{className:"text-xs",children:["L: ",e.jml_siswa_l_7," | P: ",e.jml_siswa_p_7]}),s.jsxs("div",{className:"text-xs font-semibold",children:["Total: ",e.jml_siswa_l_7+e.jml_siswa_p_7]})]})}),s.jsx("td",{children:s.jsxs("div",{className:"text-sm",children:[s.jsxs("div",{children:["Kelas: ",e.jml_kelas_8]}),s.jsxs("div",{className:"text-xs",children:["L: ",e.jml_siswa_l_8," | P: ",e.jml_siswa_p_8]}),s.jsxs("div",{className:"text-xs font-semibold",children:["Total: ",e.jml_siswa_l_8+e.jml_siswa_p_8]})]})}),s.jsx("td",{children:s.jsxs("div",{className:"text-sm",children:[s.jsxs("div",{children:["Kelas: ",e.jml_kelas_9]}),s.jsxs("div",{className:"text-xs",children:["L: ",e.jml_siswa_l_9," | P: ",e.jml_siswa_p_9]}),s.jsxs("div",{className:"text-xs font-semibold",children:["Total: ",e.jml_siswa_l_9+e.jml_siswa_p_9]})]})}),s.jsx("td",{children:s.jsxs("div",{className:"text-sm font-semibold",children:[s.jsxs("div",{children:["Kelas: ",t.totalKelas]}),s.jsxs("div",{className:"text-xs",children:["L: ",t.totalL," | P: ",t.totalP]}),s.jsxs("div",{className:"text-base",children:["Total: ",t.totalSiswa]})]})}),s.jsx("td",{children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(c,{href:typeof route=="function"&&route("admin.data-siswa.edit",e.id)&&route("admin.data-siswa.edit",e.id)!=="#"||`/admin/data-siswa/${e.id}/edit`,children:s.jsx(x,{variant:"ghost",size:"sm",className:"btn-sm",children:s.jsx(S,{className:"h-4 w-4"})})}),s.jsx(x,{variant:"ghost",size:"sm",className:"text-error btn-sm hover:bg-error/10",onClick:()=>p(e.id),children:s.jsx(T,{className:"h-4 w-4"})})]})})]},e.id)})})]})}),i.links.length>3&&s.jsx("div",{className:"mt-4 flex justify-center",children:s.jsx("div",{className:"join",children:i.links.map((e,a)=>s.jsx(c,{href:e.url||"#",className:`btn join-item btn-sm ${e.active?"btn-active":e.url?"":"btn-disabled"}`,dangerouslySetInnerHTML:{__html:e.label}},a))})})]})]})]}),s.jsx(y,{isOpen:w,onClose:()=>{o(!1),d(null)},onConfirm:f,title:"Hapus Data Siswa",message:"Apakah Anda yakin ingin menghapus data siswa ini? Tindakan ini tidak dapat dibatalkan.",confirmText:"Hapus",cancelText:"Batal",variant:"error"})]})}export{W as default};
